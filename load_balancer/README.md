Load Balancer Project for ICS 4104 Assignment 1
Overview
This project implements a Consistent Hashing Load Balancer using Docker containers to distribute incoming requests across multiple server instances. The load balancer ensures even request distribution, scalability with varying numbers of servers, and automatic recovery from server failures by adding new servers when needed. The system is designed to meet the requirements of Assignment 1, including load distribution (A-1), scalability (A-2), failure recovery (A-3), and hash function modifications (A-4).
The load balancer is built with Python and Flask, utilizing Docker for containerization, and includes a heartbeat mechanism to monitor server health. Servers are implemented as separate Docker containers responding to HTTP requests.
Installation Instructions
Prerequisites

Docker: Ensure Docker is installed and running on your system. Verify with sudo systemctl status docker.
Git: For cloning the repository.
Python 3.8: Required for building and running the images.

Steps

Clone the Repository:
git clone https://github.com/yourusername/load_balancer.git
cd load_balancer


Build Docker Images:

Build the load balancer image:docker build -f Dockerfile.load_balancer -t load_balancer_image .


Build the server image:docker build -f Dockerfile.server -t server_image .




Verify Images:
docker images

Ensure load_balancer_image and server_image are listed.


Usage Guidelines
Starting the System

Run the Load Balancer:
docker run -d --name load_balancer --network load_balancer_network -p 5000:5000 -v /var/run/docker.sock:/var/run/docker.sock -u $(id -u):$(getent group docker | cut -d: -f3) load_balancer_image


If the group command fails, use -u 0:0 for root access.


Run the Servers:
docker run -d --name server1 --network load_balancer_network server_image
docker run -d --name server2 --network load_balancer_network server_image
docker run -d --name server3 --network load_balancer_network server_image


Register Servers:
curl -X POST http://localhost:5000/add -H "Content-Type: application/json" -d '{"n": 3, "hostnames": ["server1", "server2", "server3"]}'


Check Status:
curl http://localhost:5000/rep

Expected response: {"message":{"N":3,"replicas":["server1","server2","server3"],"status":"successful"}}.


Endpoints

/home: Routes requests to a server, returning a greeting.
/add: Registers new servers (POST with JSON {"n": 3, "hostnames": ["server1", "server2", "server3"]}).
/rm: Removes servers (DELETE with JSON {"n": 1, "hostnames": ["server1"]}).
/rep: Returns the current replication state.

Testing
Test Cases

A-1 (Load Distribution): Verifies ~3333 requests per server for N=3 over 10,000 requests.
A-2 (Scalability): Tests load distribution for N=2 to N=6, expecting even splits and decreasing average load.
A-3 (Failure Recovery): Confirms a new server is added when one fails, maintaining N=3.
A-4 (Hash Function Modifications): Ensures consistent hashing with md5 and virtual nodes.

Running Tests

Ensure the load balancer and servers are running.

Execute the test script:
make test


This runs test_requests.py, generating load_distribution.png and scalability.png.


Check output files:
ls -l *.png



Deployment Instructions

Prepare Environment: Follow the installation steps on the target system.
Start Network:docker network create load_balancer_network


Deploy Containers: Use the docker run commands above to start the load balancer and servers.
Monitor: Use docker ps and docker logs load_balancer to ensure all components are running.
Scale: Add more servers by running additional docker run commands and registering them via /add.

Dependencies

Dockerfile.load_balancer: Includes python:3.8-slim, flask, requests, docker, aiohttp, matplotlib.
Dockerfile.server: Includes python:3.8-slim, flask.
requirements.txt: Lists all Python dependencies.

Additional Materials

Images: load_distribution.png and scalability.png generated by make test.
Source Files:
load_balancer.py: Implements the load balancer logic.
server.py: Defines server endpoints.
test_requests.py: Contains test cases.
Dockerfile.load_balancer and Dockerfile.server: Configuration for building images.


External Libraries: Uses docker-py for container management, included via requirements.txt.
